CREATE INDEX myIdx ON carts(sku, country, customer_ud);

SELECT *
FROM carts
WHERE sku = 192 AND country = 'ru';

SELECT *
FROM carts
WHERE country = 'ru' AND customer_ud = 10;


----


Здесь мы создаем btree-индекс на таблицу carts. Индекс на столбец sku это нормально. А вот столбец country - это скорее всего неселективная колонка, стран всего около 150. Запрос может даже работать медленее из-за индекса на столбец country, потому что мы сначала пойдем консультироваться у планировщика запросов, мы поймем что у нас btree-индекс будет рабтать медленее, будем выполнять sequence scan.

В первом запросе индекс будет использоваться и на столбец sku и на country.

В первом запросе индекс не будет работать, потому что в индексе у нас первый столбец sku, а в запросе мы его не используем. Потому что это составной индекс и нужно чтобы столбец sku был в запросе.