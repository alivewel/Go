–£ –Ω–∞—Å –µ—Å—Ç—å –∏–Ω–¥–µ–∫—Å –ø–æ –∫–æ–ª–æ–Ω–∫–µ country, –∫–∞–∫–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞? –ß–µ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É–µ—Ç—Å—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ–≥–¥–∞ —Å—Ç–æ–∏—Ç –ø–ª–∞–Ω –∑–∞–ø—Ä–æ—Å–∞ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞?
–°–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –°–µ–ª–µ–∫—Ç–∏–≤–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞.

–°–º–æ—Ç—Ä–∏—Ç –ª–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?

–î–∞, —Ç—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ **–ø—Ä–∞–≤** ‚Äî –∫–ª—é—á–µ–≤—ã–º —Ñ–∞–∫—Ç–æ—Ä–æ–º –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏—è –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∏–Ω–¥–µ–∫—Å–∞ —è–≤–ª—è–µ—Ç—Å—è **—Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** —Å—Ç–æ–ª–±—Ü–∞, –∏ –¥–∞ ‚Äî **–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ (query planner)** **—Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É**.

–î–∞–≤–∞–π –ø–æ —à–∞–≥–∞–º:

---

### üìå –ß—Ç–æ —Ç–∞–∫–æ–µ **—Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**?

**–°–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** ‚Äî —ç—Ç–æ –¥–æ–ª—è —Å—Ç—Ä–æ–∫, –∫–æ—Ç–æ—Ä—É—é –≤—ã–±–∏—Ä–∞–µ—Ç —É—Å–ª–æ–≤–∏–µ:

$$
\text{–°–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å} = \frac{\text{–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —É—Å–ª–æ–≤–∏—é}}{\text{–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ}}
$$

* –ß–µ–º **–º–µ–Ω—å—à–µ —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**, —Ç–µ–º **—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ** –∏–Ω–¥–µ–∫—Å.
* –ï—Å–ª–∏ —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚âà 1 (—Ç–æ –µ—Å—Ç—å –ø–æ—á—Ç–∏ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥—Ö–æ–¥—è—Ç) ‚Üí **–∏–Ω–¥–µ–∫—Å –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω** ‚Üí —Å–∫–∞–Ω –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü—ã –±—É–¥–µ—Ç –±—ã—Å—Ç—Ä–µ–µ.

---

### üß† –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ —É—á–∏—Ç—ã–≤–∞–µ—Ç:

#### ‚úÖ 1. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** (–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç `ANALYZE` / –∞–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏):

* –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ–ª–æ–Ω–æ–∫.
* –ö–æ–ª-–≤–æ **—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**.
* –ö–æ–ª-–≤–æ **NULL**.
* –ß–∞—Å—Ç–æ—Ç–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (most common values).
* –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã.

> –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å **–æ–∂–∏–¥–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫** –∏ **–≤—ã–±—Ä–∞—Ç—å –º–µ–∂–¥—É Index Scan, Seq Scan, Bitmap Scan –∏ –¥—Ä.**

#### ‚úÖ 2. **–°—Ç–æ–∏–º–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π** (`cost`) –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö CPU, I/O –∏ –ø–∞–º—è—Ç–∏:

* –°—Ç–æ–∏–º–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞ vs. –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ –ø–æ —Ç–∞–±–ª–∏—Ü–µ (`Seq Scan`).
* –†–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã, —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö, —Ä–∞–∑–º–µ—Ä –∏–Ω–¥–µ–∫—Å–∞.
* –ù–∞–ª–∏—á–∏–µ –¥—Ä—É–≥–∏—Ö —É—Å–ª–æ–≤–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `LIMIT`, `JOIN`, `ORDER BY`), –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç "–ø–µ—Ä–µ–≤–µ—Å–∏—Ç—å" –≤—ã–±–æ—Ä.

#### ‚úÖ 3. **–§–∏–∑–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω–¥–µ–∫—Å–∞**:

* B-Tree (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) ‚Äî —Ö–æ—Ä–æ—à –¥–ª—è `=`, `<`, `>`, `BETWEEN`, `IN`.
* GIN, GiST ‚Äî –¥–ª—è –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ –º–∞—Å—Å–∏–≤–æ–≤.
* Hash ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è `=` (–≤ PostgreSQL, –Ω–æ —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è).

---

### üß™ –ü—Ä–∏–º–µ—Ä

#### –¢–∞–±–ª–∏—Ü–∞ `users` (10 –º–ª–Ω —Å—Ç—Ä–æ–∫)

–ò–Ω–¥–µ–∫—Å –ø–æ `country`.

* `SELECT * FROM users WHERE country = 'USA';`

  * –ï—Å–ª–∏ `country = 'USA'` –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç 7 –º–ª–Ω —Å—Ç—Ä–æ–∫ ‚Üí –∏–Ω–¥–µ–∫—Å **–Ω–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è** (—Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∏–∑–∫–∞—è).
  * –ï—Å–ª–∏ `country = 'Iceland'` –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç 20 —Å—Ç—Ä–æ–∫ ‚Üí –∏–Ω–¥–µ–∫—Å **–±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è** (—Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤—ã—Å–æ–∫–∞—è).

---

### üõ† –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?

#### PostgreSQL:

```sql
-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
SELECT * FROM pg_stats WHERE tablename = 'users' AND attname = 'country';

-- –û–±–Ω–æ–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é:
ANALYZE users;
```

#### MySQL:

```sql
SHOW INDEX FROM users;
ANALYZE TABLE users;
```

---

### üí° –í—ã–≤–æ–¥:

| –í–æ–ø—Ä–æ—Å                                                         | –û—Ç–≤–µ—Ç                                                  |
| -------------------------------------------------------------- | ------------------------------------------------------ |
| –°–º–æ—Ç—Ä–∏—Ç –ª–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?                          | ‚úÖ –î–∞                                                   |
| –ö–ª—é—á–µ–≤–æ–π —Ñ–∞–∫—Ç–æ—Ä –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞?                            | ‚úÖ –°–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å                                        |
| –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –∏–Ω–¥–µ–∫—Å, –µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ—á—Ç–∏ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏? | ‚ùå –ù–µ—Ç ‚Äî –±—É–¥–µ—Ç Seq Scan                                 |
| –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?                               | –ü—Ä–∏ –º–∞—Å—Å–æ–≤–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–¥ –≤–∞–∂–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ |

---

–•–æ—á–µ—à—å ‚Äî –º–æ–≥—É –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å `EXPLAIN ANALYZE`, –≥–¥–µ –ø—Ä–∏ —Ä–∞–∑–Ω–æ–π —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –≤—ã–±–∏—Ä–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.
