user
id integer | balance real

func withdrawBalance(user_id int32, amount float32) {
    balance := exec('select balance from user u where u.id=$1', user_id)
    if balance - amount >= 0.0 {
        exec('update user u set balance=balance-$1', amount)
        return exec('select balance from user u where u.id=$1', user_id)
    }
}