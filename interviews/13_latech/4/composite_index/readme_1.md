–ö–∞–∫–∏–µ –µ—Å—Ç—å –ø—Ä–∞–≤–∏–ª–∞, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å?
To do: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
–í—Å–µ–≥–¥–∞ —Å—Ç–æ–ª–±—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ —Ä–æ–≤–Ω–æ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏ –ø–µ—Ä–≤—ã–π, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –±–æ–ª—å—à–µ –∏–ª–∏ –º–µ–Ω—å—à–µ, –∞ –≤—Å–µ –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∞–≤–µ–µ –Ω–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è.

–ú—ã –Ω–∞–≤–µ—Å–∏–º –∏–Ω–¥–µ–∫—Å –Ω–∞ –∫–æ–ª–æ–Ω–∫—É customer_id, country –∏ sku. –ï—Å–ª–∏ —É –Ω–∞—Å –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ –±—É–¥–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–ª—é customer_id, –±—É–¥–µ—Ç –ª–∏ —ç—Ç–æ—Ç –∏–Ω–¥–µ–∫—Å –ø—Ä–∏–º–µ–Ω–µ–Ω?

–ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å –±—É–¥–µ—Ç –ª–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω –∏–Ω–¥–µ–∫—Å, –∫–∞–∫ —Ç—ã –º–æ–∂–µ—à—å —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å?

–í–æ–ø—Ä–æ—Å –ø—Ä–æ —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –≤ SQL (–Ω–∞–ø—Ä–∏–º–µ—Ä, PostgreSQL, MySQL –∏ –¥—Ä.) ‚Äî –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –∏ —á–∞—Å—Ç—ã–π. –ù–∏–∂–µ –∫—Ä–∞—Ç–∫–æ –∏ —Ç–æ—á–Ω–æ:

---

### üìå **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å?**

–î–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å –∏–Ω–¥–µ–∫—Å:
`CREATE INDEX idx_example ON table (customer_id, country, sku);`

–ò–Ω–¥–µ–∫—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ **—Ç–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ, –∫–∞–∫ –æ–Ω —Å–æ–∑–¥–∞–Ω** ‚Äî —ç—Ç–æ –≤–∞–∂–Ω–æ. –¢–æ –µ—Å—Ç—å:

1. **customer\_id** ‚Äî —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π (–ª–µ–≤—ã–π);
2. –∑–∞—Ç–µ–º **country**;
3. –∑–∞—Ç–µ–º **sku**.

---

### ‚úÖ **–ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

#### 1. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ**

* –ï—Å–ª–∏ –≤ `WHERE` –µ—Å—Ç—å `customer_id` ‚Äî **–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –ø–æ–ª—è**: `customer_id`, `country`, `sku`.
* –ï—Å–ª–∏ `customer_id` **–Ω–µ—Ç** ‚Äî –∏–Ω–¥–µ–∫—Å **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ–æ–±—â–µ** (–ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞).
* –ï—Å–ª–∏ –µ—Å—Ç—å `customer_id`, –Ω–æ **–ø–æ –Ω–µ–º—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤—É (`>`, `<`)**, —Ç–æ:

  * **—Ç–æ–ª—å–∫–æ customer\_id –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**, –≤—Å–µ –ø—Ä–∞–≤–µ–µ ‚Äî **–∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è**.

#### 2. **–†–∞–≤–Ω–æ (`=`) ‚Äî —Ö–æ—Ä–æ—à–æ, `>`/`<` ‚Äî –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç**

–ü—Ä–∏–º–µ—Ä:

```sql
-- customer_id = ? AND country = ?       => –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è customer_id, country
-- customer_id = ? AND country > ?       => –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ customer_id
-- country = ? AND sku = ?               => –∏–Ω–¥–µ–∫—Å –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ customer_id –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
```

---

### ‚ùì**–ë—É–¥–µ—Ç –ª–∏ –∏–Ω–¥–µ–∫—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è, –µ—Å–ª–∏ –Ω–µ—Ç customer\_id –≤ WHERE?**

–ù–µ—Ç, **–Ω–µ –±—É–¥–µ—Ç**.
–ò–Ω–¥–µ–∫—Å `(customer_id, country, sku)` —Ç—Ä–µ–±—É–µ—Ç **–Ω–∞–ª–∏—á–∏—è customer\_id** –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. –ë–µ–∑ –Ω–µ–≥–æ ‚Äî PostgreSQL –∏–ª–∏ MySQL –Ω–µ —Å–º–æ–≥—É—Ç –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å (–æ–Ω –Ω–µ "–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è" —Å –Ω—É–∂–Ω–æ–≥–æ –ø–æ–ª—è).

---

### üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –∏–Ω–¥–µ–∫—Å?

–í —Ä–∞–∑–Ω—ã—Ö –°–£–ë–î ‚Äî –ø–æ-—Ä–∞–∑–Ω–æ–º—É, –Ω–æ –æ–±—â–∏–µ —Å–ø–æ—Å–æ–±—ã:

#### PostgreSQL:

```sql
EXPLAIN ANALYZE
SELECT * FROM orders WHERE customer_id = 5 AND country = 'DE';
```

–í—ã–≤–æ–¥ –ø–æ–∫–∞–∂–µ—Ç `Index Scan` ‚Äî –µ—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

#### MySQL:

```sql
EXPLAIN
SELECT * FROM orders WHERE customer_id = 5 AND country = 'DE';
```

–°–º–æ—Ç—Ä–∏ –≤ –∫–æ–ª–æ–Ω–∫—É `key` ‚Äî –∏–º—è –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞.

---

### üí° –†–µ–∑—é–º–µ

| –£—Å–ª–æ–≤–∏–µ –∑–∞–ø—Ä–æ—Å–∞                   | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–Ω–¥–µ–∫—Å `(customer_id, country, sku)`? |
| --------------------------------- | -------------------------------------------------- |
| `customer_id = ? AND country = ?` | ‚úÖ –î–∞                                               |
| `customer_id > ? AND country = ?` | ‚ö†Ô∏è –¢–æ–ª—å–∫–æ `customer_id`                            |
| `country = ? AND sku = ?`         | ‚ùå –ù–µ—Ç                                              |

---

–•–æ—á–µ—à—å ‚Äî –º–æ–≥—É —Å–æ—Å—Ç–∞–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏.

