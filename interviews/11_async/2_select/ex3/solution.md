-2:43:00

В предыдущем примере мы внутри select только читали. В этом примере рассмотрим процесс чтения и записи в рамках одного select. Это нам открывает возможность для завершения внешних каналов и функций используя канал отмены.

У нас есть канал отмены в него мы положим пустую структуру (она не занимает места и у нее есть признак наличия чего-то в ней). Вызовем функцию, которая будет бесконечно печатать значения. Внутри этой функции будет бесконечный цикл, внутри этого цикла будет select. 

Первый кейс будет выполняться в случае, когда мы что-то прочитаем из канала отмены. В этом случае мы завершим работу всей функции.

Во втором кейсе мы будем инкрементировать счетчик.

В цикле for range мы читаем данные из канала и как только счетчик будет больше 3 мы отправим значение в канал отмены.