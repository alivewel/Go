1) l + r - 1
Неправильно считал размер окна. Невнимательность.
2) r - l + 1
Неправильно считал размер окна. Невнимательность.
