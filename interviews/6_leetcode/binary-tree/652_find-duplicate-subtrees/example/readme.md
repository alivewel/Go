–†–∞–∑–±–µ—Ä—ë–º **–ø–æ–¥—Ä–æ–±–Ω–æ** –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ **–¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –ø–æ–¥–¥–µ—Ä–µ–≤—å–µ–≤** (–Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –∑–∞–¥–∞—á–∏ [LeetCode 652 ‚Äî Find Duplicate Subtrees](https://leetcode.com/problems/find-duplicate-subtrees/)).

---

## üß© –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

–î–∞–Ω–æ –±–∏–Ω–∞—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ. –ù—É–∂–Ω–æ **–Ω–∞–π—Ç–∏ –≤—Å–µ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è, –∫–æ—Ç–æ—Ä—ã–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è** ‚Äî —Ç–æ –µ—Å—Ç—å –∏–º–µ—é—Ç **–æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∑–Ω–∞—á–µ–Ω–∏—è**. –ù—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å **–ø–æ –æ–¥–Ω–æ–º—É –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—é –∫–∞–∂–¥–æ–≥–æ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –ø–æ–¥–¥–µ—Ä–µ–≤–∞**.

---

## üîç –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è: —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Ä–µ–≤–∞

–ú—ã —Ö–æ—Ç–∏–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã. –û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ ‚Äî **–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–µ–≤–æ –∫–∞–∫ —Å—Ç—Ä–æ–∫—É** (—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –µ–≥–æ).

### –ü—Ä–∏–º–µ—Ä:

–í–æ—Ç —Ç–∞–∫–æ–µ –¥–µ—Ä–µ–≤–æ:

```
    1
   / \
  2   3
 /   / \
4   2   4
   /
  4
```

–ò —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–∞ (–≤ —Ñ–æ—Ä–º–∞—Ç–µ `val,left,right`):

- —É–∑–µ–ª —Å `4` ‚Üí `"4,#,#"`
- —É–∑–µ–ª —Å `2` —Å–ª–µ–≤–∞ ‚Üí `"2,4,#,#,#"`
- —É–∑–µ–ª —Å `2` —Å–ø—Ä–∞–≤–∞ ‚Üí —Ç–æ–∂–µ `"2,4,#,#,#"` ‚áí –¥—É–±–ª–∏–∫–∞—Ç!
- —É–∑–µ–ª —Å `3` ‚Üí `"3,2,4,#,#,#,4,#,#"`
- —É–∑–µ–ª —Å `1` ‚Üí `"1,2,4,#,#,#,3,..."`

---

## üß† –ê–ª–≥–æ—Ä–∏—Ç–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º

### 1. –û–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞ DFS (—Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö)
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º –ª–µ–≤–æ–µ –∏ –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è.

```go
serial := fmt.Sprintf("%d,%s,%s", node.Val, dfs(node.Left), dfs(node.Right))
```

### 2. –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é –≤ —Ö–µ—à-—Ç–∞–±–ª–∏—Ü—É

- –ö–ª—é—á: —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ–∫–∏.
- –ó–Ω–∞—á–µ–Ω–∏–µ: —Å—á—ë—Ç—á–∏–∫, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å—Ç—Ä–µ—á–∞–ª–æ—Å—å —Ç–∞–∫–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ.

```go
count[serial]++
```

### 3. –î–æ–±–∞–≤–ª—è–µ–º –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –µ—Å–ª–∏ –≤—Å—Ç—Ä–µ—Ç–∏–ª–æ—Å—å **–≤—Ç–æ—Ä–æ–π —Ä–∞–∑**

```go
if count[serial] == 2 {
    result = append(result, node)
}
```

> –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ –≤—Ç–æ—Ä–æ–π —Ä–∞–∑?  
> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ö–æ—Ç–∏–º **–ø–æ –æ–¥–Ω–æ–º—É —ç–∫–∑–µ–º–ø–ª—è—Ä—É** –∫–∞–∂–¥–æ–≥–æ –¥—É–±–ª–∏–∫–∞—Ç–∞. –ü–µ—Ä–≤—ã–π —Ä–∞–∑ ‚Äî –Ω–æ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ, –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ ‚Äî –∑–Ω–∞—á–∏—Ç, –æ–Ω–æ —Ç–æ—á–Ω–æ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è.

---

## ‚úÖ Go-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

```go
type TreeNode struct {
    Val   int
    Left  *TreeNode
    Right *TreeNode
}

func findDuplicateSubtrees(root *TreeNode) []*TreeNode {
    var result []*TreeNode
    count := make(map[string]int)

    var dfs func(node *TreeNode) string
    dfs = func(node *TreeNode) string {
        if node == nil {
            return "#"
        }
        serial := fmt.Sprintf("%d,%s,%s", node.Val, dfs(node.Left), dfs(node.Right))
        count[serial]++
        if count[serial] == 2 {
            result = append(result, node)
        }
        return serial
    }

    dfs(root)
    return result
}
```

---

## ‚è±Ô∏è –°–ª–æ–∂–Ω–æ—Å—Ç—å

- **–í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å**:  
  \( O(N \cdot M) \), –≥–¥–µ:
  - \( N \) ‚Äî —á–∏—Å–ª–æ —É–∑–ª–æ–≤,
  - \( M \) ‚Äî —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–¥–¥–µ—Ä–µ–≤–∞ (–≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ ‚Äî –¥–æ \( O(N) \)).

- **–ü–∞–º—è—Ç—å**:  
  \( O(N \cdot M) \) ‚Äî –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–π –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

> –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é –≤ –≤–∏–¥–µ —Ö–µ—à–µ–π –∏–ª–∏ ID).

---

## üí° –£–ª—É—á—à–µ–Ω–∏–µ: —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ ID

–í–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID:

```go
type uid int
map[string]uid
```

–≠—Ç–æ –¥–∞—Å—Ç –ø—Ä–∏—Ä–æ—Å—Ç –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚Äî –º–µ–Ω—å—à–µ –∞–ª–ª–æ–∫–∞—Ü–∏–π —Å—Ç—Ä–æ–∫ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–π.

---

## ‚ùì –•–æ—á–µ—à—å –µ—â–µ:
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—é –Ω–∞ **Java**, **Python** –∏–ª–∏ –¥—Ä—É–≥–æ–º —è–∑—ã–∫–µ?
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å **—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º** –±–µ–∑ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏?
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é, –∫–∞–∫ —Å—Ç—Ä–æ–∏—Ç—Å—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è?

–°–∫–∞–∂–∏, –∏ —è –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é.