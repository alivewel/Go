–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã/–ø–æ–¥—Ö–æ–¥—ã –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π?

---

–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å!
**–ì–∞—Ä–∞–Ω—Ç–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π** ‚Äî –∫–ª—é—á–µ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –≤ **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö**, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –±—Ä–æ–∫–µ—Ä–æ–≤ (Kafka, RabbitMQ –∏ —Ç. –¥.), –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤, –æ—á–µ—Ä–µ–¥–µ–π –∏ —Å–æ–±—ã—Ç–∏–π–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä.

---

## ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ **—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã** –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∏—Ö –ø–æ —É—Ä–æ–≤–Ω—è–º: **–ø—Ä–æ—Ç–æ–∫–æ–ª, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ–¥**.

---

## 1. **üß± –£—Ä–æ–≤–µ–Ω—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–±—Ä–æ–∫–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π)**

| –ë—Ä–æ–∫–µ—Ä             | –ì–∞—Ä–∞–Ω—Ç–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏               | –ú–µ—Ö–∞–Ω–∏–∑–º—ã                     |
| ------------------ | ------------------------------- | ----------------------------- |
| **Kafka**          | `at-least-once`, `exactly-once` | Offset, ack, transactional id |
| **RabbitMQ**       | `at-most-once`, `at-least-once` | Ack, persistent queues        |
| **NATS JetStream** | `at-least-once`, `exactly-once` | Durable consumers, replay     |
| **AWS SQS**        | `at-least-once`                 | Visibility timeout, retries   |
| **Google Pub/Sub** | `at-least-once`                 | Ack timeout, retry policies   |

üìå **–í—ã–≤–æ–¥:**
–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–∂–µ—Ç **–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É**, –µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω **ack + retry + persistence**.

---

## 2. **üîÅ –ü–æ–¥—Ö–æ–¥—ã –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –∫–æ–¥–µ**

### ‚úÖ `At-least-once delivery` (–¥–æ—Å—Ç–∞–≤–∏–º —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ä–∞–∑)

* –°–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥
* –ù–µ–æ–±—Ö–æ–¥–∏–º–∞ **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤** (—á—Ç–æ–±—ã –¥—É–±–ª–∏ –Ω–µ –ø–æ—Ä—Ç–∏–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å Kafka, RabbitMQ, SQS –∏ —Ç. –¥.

```go
if !alreadyProcessed(event.ID) {
   process(event)
   markAsProcessed(event.ID)
}
```

---

### ‚úÖ `Exactly-once delivery` (–¥–æ—Å—Ç–∞–≤–∏–º —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑)

* –°–ª–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑—É–µ–º–æ, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ
* –û–±—ã—á–Ω–æ —Ç—Ä–µ–±—É–µ—Ç **—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏–ª–∏ outbox-–ø–∞—Ç—Ç–µ—Ä–Ω–∞**
* Kafka –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç natively (`idempotent producer + transactional consumer`)

---

## 3. üß© **Outbox Pattern (–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±)**

> –°–æ–±—ã—Ç–∏–µ —Å–Ω–∞—á–∞–ª–∞ **–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ outbox-—Ç–∞–±–ª–∏—Ü—É –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è**, –∞ –ø–æ—Ç–æ–º **–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ**.

### üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –í–Ω—É—Ç—Ä–∏ –ë–î:

   * `BEGIN`
   * –ò–∑–º–µ–Ω–∏—Ç—å –±–∏–∑–Ω–µ—Å-–¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑)
   * –ó–∞–ø–∏—Å–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –≤ —Ç–∞–±–ª–∏—Ü—É `outbox_events`
   * `COMMIT`

2. –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å (poller –∏–ª–∏ Debezium) —á–∏—Ç–∞–µ—Ç `outbox_events` –∏ –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ Kafka/RabbitMQ

### ‚úÖ –ü–ª—é—Å—ã:

* –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞
* –£—Å—Ç–æ–π—á–∏–≤–æ –∫ —Å–±–æ—è–º
* –ü–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å

---

## 4. üßæ **Transactional Outbox + Change Data Capture (CDC)**

* –°–∏—Å—Ç–µ–º—ã –≤—Ä–æ–¥–µ **Debezium** —Å–ª—É—à–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ë–î –∏ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —Å–æ–±—ã—Ç–∏—è**
* –ß–∞—Å—Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å Kafka

---

## 5. üìå **Persistent Queues**

* –û—á–µ—Ä–µ–¥–∏ —Å **–¥–∏—Å–∫–æ–≤—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º** (–Ω–µ —Ç–µ—Ä—è—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ —Å–±–æ—è—Ö)
* –ü—Ä–∏–º–µ—Ä: Kafka, RabbitMQ —Å durable queue, Redis Streams

---

## 6. ‚õî **–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ ack / retry**

| –ü—Ä–æ–±–ª–µ–º–∞              | –†–µ—à–µ–Ω–∏–µ                                                                                    |
| --------------------- | ------------------------------------------------------------------------------------------ |
| –ü–æ—Ç–µ—Ä—è —Å–æ–æ–±—â–µ–Ω–∏—è      | –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ (`retry`, backoff)                                                       |
| –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Å–æ–±—ã—Ç–∏—è | –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, deduplication –ø–æ ID                                                       |
| –ü–æ—Ä—è–¥–æ–∫ —Å–æ–±—ã—Ç–∏–π       | Partition key –≤ Kafka, seq/offset                                                          |
| –ù–µ—Ç ack               | –°–æ–æ–±—â–µ–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è **—É—Å–ø–µ—à–Ω–æ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º**, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —É–ø–∞–ª ‚Äî —ç—Ç–æ **–æ–ø–∞—Å–Ω–æ!** |

---

## üß† –†–µ–∑—é–º–µ: –∫–∞–∫ **–æ–±–µ—Å–ø–µ—á–∏—Ç—å –Ω–∞–¥—ë–∂–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É**

| –ú–µ—Ç–æ–¥/–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç          | –ì–∞—Ä–∞–Ω—Ç–∏—è | –¢—Ä–µ–±—É–µ—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏? |
| ------------------------- | -------- | ------------------------ |
| Kafka + ack               | ‚úÖ        | ‚úÖ                        |
| RabbitMQ + manual ack     | ‚úÖ        | ‚úÖ                        |
| Outbox Pattern            | ‚úÖ        | –ù–µ—Ç                      |
| CDC + Debezium            | ‚úÖ        | –ù–µ—Ç                      |
| Exactly-once Kafka        | ‚úÖ        | ‚ùå (Kafka –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç)   |
| –ë–µ–∑ ack / fire-and-forget | ‚ùå        | ‚Äî                        |

---

## üì¶ –•–æ—á–µ—à—å –ª—É—á—à–µ? –ò—Å–ø–æ–ª—å–∑—É–π –≤–º–µ—Å—Ç–µ:

* **Outbox pattern** –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏
* **Kafka** –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏
* **OpenTelemetry** –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏
* **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–æ–≤

---

–•–æ—á–µ—à—å ‚Äî –º–æ–≥—É –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ `Outbox pattern` –≤ Go + PostgreSQL + Kafka –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å retry/ack –≤ RabbitMQ.
