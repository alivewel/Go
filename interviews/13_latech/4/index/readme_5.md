–ú–æ–∂–Ω–æ –ª–∏ —Å–∫–∞–∑–∞—Ç—å —á—Ç–æ autovacuum —ç—Ç–æ —Å–±–æ—Ä—â–∏–∫ –º—É—Å–æ—Ä–∞? –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ª–∏ —ç—Ç–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ?

–î–∞, ‚úÖ **–≤–ø–æ–ª–Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ `autovacuum` –≤ PostgreSQL ‚Äî —ç—Ç–æ –∞–Ω–∞–ª–æ–≥ "—Å–±–æ—Ä—â–∏–∫–∞ –º—É—Å–æ—Ä–∞" (garbage collector)**, –Ω–æ —Å —Ä—è–¥–æ–º —É—Ç–æ—á–Ω–µ–Ω–∏–π:

---

### üìå –ü–æ—á–µ–º—É —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å GC —É–º–µ—Å—Ç–Ω–æ?

`autovacuum`:

* **–æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏ —É–¥–∞–ª—è–µ—Ç "–º—ë—Ä—Ç–≤—ã–µ —Å—Ç—Ä–æ–∫–∏"**, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –Ω–µ –≤–∏–¥–Ω—ã –Ω–∏–∫–∞–∫–∏–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º (–∫–∞–∫ GC —É–¥–∞–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç—ã, –Ω–µ –∏–º–µ—é—â–∏–µ —Å—Å—ã–ª–æ–∫).
* **–æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –¥–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**, —á—Ç–æ–±—ã –µ–≥–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.
* **–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ "–º—É—Å–æ—Ä–∞"** –æ—Ç —á–∞—Å—Ç—ã—Ö `UPDATE` –∏ `DELETE`.

–ü—Ä–∏–º–µ—Ä:

```sql
DELETE FROM users WHERE last_login < now() - interval '1 year';
```

–°—Ç—Ä–æ–∫–∏ —Å—Ä–∞–∑—É –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è ‚Äî –æ–Ω–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ **–Ω–µ–≤–∏–¥–∏–º—ã–µ**, –Ω–æ –æ—Å—Ç–∞—é—Ç—Å—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–∞ –¥–∏—Å–∫–µ.
`autovacuum` –ø–æ—Ç–æ–º:

* —É–¥–∞–ª—è–µ—Ç —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏,
* "—É–ø–ª–æ—Ç–Ω—è–µ—Ç" —Å—Ç—Ä–∞–Ω–∏—Ü—ã,
* –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.

---

### üß† –û—Ç–ª–∏—á–∏—è –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ GC:

| –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å                   | `autovacuum`                  | –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π GC (Java, Python) |
| ----------------------------- | ----------------------------- | ------------------------------ |
| –û–±—ä–µ–∫—Ç—ã —É–¥–∞–ª—è—é—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ? | ‚ùå –ù–µ—Ç ‚Äî "–ø–æ–∑–¥–Ω–µ–µ —É–¥–∞–ª–µ–Ω–∏–µ"    | ‚úÖ –û–±—ã—á–Ω–æ –¥–∞                    |
| –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?    | ‚úÖ –î–∞ (–Ω–æ –º–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é)       | ‚úÖ –î–∞                           |
| –û—á–∏—â–∞–µ—Ç –ø–∞–º—è—Ç—å?               | ‚ùå –ù–µ—Ç, –æ—á–∏—â–∞–µ—Ç **–¥–∏—Å–∫**       | ‚úÖ –î–∞                           |
| –£—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫–∏?             | ‚ùå –ù–µ—Ç, —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ MVCC –∏ XID | ‚úÖ –î–∞                           |

---

### üõ† –ß—Ç–æ –µ—â—ë –¥–µ–ª–∞–µ—Ç `autovacuum`, –∫—Ä–æ–º–µ —É–¥–∞–ª–µ–Ω–∏—è –º—É—Å–æ—Ä–∞?

1. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ** –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ ‚Üí —É–ª—É—á—à–∞–µ—Ç –ø–ª–∞–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤.
2. **"–ó–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç"** —Å—Ç–∞—Ä—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (`FREEZE`), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è transaction ID.
3. –†–∞–±–æ—Ç–∞–µ—Ç **–ø–æ –ø–æ—Ä–æ–≥–∞–º**: –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–µ —Å—Ä–∞–∑—É, –∞ –µ—Å–ª–∏ —á–∏—Å–ª–æ "–≥—Ä—è–∑–Ω—ã—Ö —Å—Ç—Ä–æ–∫" –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ø–æ—Ä–æ–≥.

---

### üí° –í—ã–≤–æ–¥:

‚úÖ **–î–∞, `autovacuum` –º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞—Ç—å —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞ PostgreSQL ‚Äî —ç—Ç–æ –∞–Ω–∞–ª–æ–≥ GC, –Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**. –û–Ω:

* —É–¥–∞–ª—è–µ—Ç "–Ω–µ–≤–∏–¥–∏–º—ã–µ" —Å—Ç—Ä–æ–∫–∏,
* –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –¥–∏—Å–∫,
* –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–≥–∞—Ç—å –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –ø–æ–∫–∞–∂—É –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Å—Ç—Ä–æ–∫–∏ –∏ –∫–∞–∫ –µ—ë "—Å–æ–±–∏—Ä–∞–µ—Ç" autovacuum.
